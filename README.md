# ForestGuard
ForestGuard: Мониторинг вырубки лесов и прогноз восстановления
Автор: Марьяновский В.А.
Дата: Март 2025
Проект: Разработан для хакатона
Описание проекта

"ForestGuard" — это инструмент для автоматизированного мониторинга вырубки лесов и прогнозирования времени их восстановления. Проект использует спутниковые снимки Sentinel-2 и климатические данные для анализа состояния лесов в Шебалинском районе Республики Алтай (координаты: 85.7–86.1°E, 51.2–51.4°N). Основные задачи:
Обнаружение зон вырубки с помощью классификации на основе индекса NDVI.
Оценка времени, необходимого для восстановления лесного покрова.
Регионом был выбран "Шебалинский район, Республика Алтай" так как из общедоступных источников известно, что в 2023 году там был зафиксирован высокий уровень незаконной вырубки леса.

Зачем это нужно?
Вырубка лесов — глобальная проблема, влияющая на экологию, климат и жизнь местных сообществ. "ForestGuard" помогает:
Экологам: Быстро выявлять зоны вырубки для защиты природы.
Властям: Контролировать незаконную деятельность и планировать лесовосстановление.
Местным жителям: Сохранять лесные ресурсы, от которых зависит их быт.
Учёным: Собирать данные для исследований изменения климата.
Проект актуален для Шебалинского района, где тайга играет ключевую роль в экосистеме.

Как это работает?
Данные:
Sentinel-2: Спутниковые снимки (Red, Green, Blue, NIR) за 2023 год с разрешением 30 м.
ERA5: Климатические данные (температура, осадки).
SMAP: Влажность почвы.
Все данные загружаются через Google Earth Engine (GEE).
Модели:
ClearcutCNN: U-Net-подобная сеть для сегментации (3 класса: вырубка, лес, другое). Выбрана за эффективность в обработке пространственных данных.
RecoveryModel: CNN для регрессии времени восстановления на основе NDVI и климата. Проста и подходит для ограниченного объёма данных.
Процесс:
Регион делится на 4 субрегиона для полного покрытия.
NDVI рассчитывается как (NIR - Red) / (NIR + Red).
Классификация: вырубка (NDVI < 0.25), лес (NDVI > 0.5), другое (между).
Время восстановления: линейная модель (30 - NDVI * 20) с учётом климата.
Результаты:
Визуализация: RGB-снимок, карта классов (зелёный — вырубка, синий — лес, красный — другое), прогноз в годах.
Выходной файл: GeoTIFF с картой вырубки.
Почему выбраны эти модели?
ClearcutCNN: Компактная, быстрая, хорошо работает с пиксельной классификацией. Dropout (0.3) предотвращает переобучение.
RecoveryModel: Простая архитектура для регрессии, учитывает как снимки, так и климат. Более сложные модели (ResNet, Transformer) требуют больше данных и ресурсов, что не подходит для хакатона.
Как это может помочь людям?
Выявление незаконной вырубки в реальном времени.
Планирование восстановления лесов.
Поддержка экологических инициатив и исследований.

Как можно улучшить?
Добавить исторические данные (например, 2022) для анализа изменений.
Использовать больше каналов Sentinel-2 (B5-B7) для текстурного анализа.
Увеличить выборку данных и климатических факторов (ветер, радиация).
Перейти на глубокие сети (ResNet, полная U-Net) с GPU.
Разработать веб-интерфейс для удобного доступа.

Требования и установка
Необходимые модули
Для работы программы нужно установить следующие Python-библиотеки:
earthengine-api: Доступ к данным Google Earth Engine.
Установка: pip install earthengine-api
torch: Фреймворк PyTorch для нейронных сетей.
Установка: pip install torch (для CPU) или см. PyTorch.org для GPU.
numpy: Обработка массивов и числовые операции.
Установка: pip install numpy
matplotlib: Визуализация результатов.
Установка: pip install matplotlib
requests: HTTP-запросы для загрузки данных.
Установка: pip install requests
rasterio: Сохранение результатов в GeoTIFF.
Установка: pip install rasterio (или conda install -c conda-forge rasterio)
Установка через терминал
Открой терминал (cmd, PowerShell, Anaconda Prompt).
Установи все модули одной командой:
bash
pip install earthengine-api torch numpy matplotlib requests rasterio
Или для Anaconda:
bash
conda install -c conda-forge earthengine-api pytorch numpy matplotlib requests rasterio
Настрой Google Earth Engine:
bash
earthengine authenticate
В браузере войди в Google-аккаунт, скопируй код и вставь в терминал.
Установка в Jupyter Notebook
Запусти Jupyter:
bash
jupyter notebook
В ячейке выполни:
python
!pip install earthengine-api torch numpy matplotlib requests rasterio
!earthengine authenticate
Перезапусти ядро (Kernel -> Restart).
Проверка установки
В ячейке Jupyter или скрипте:
python
import ee
import torch
import numpy as np
import matplotlib.pyplot as plt
import requests
import rasterio
ee.Initialize(project="siberia-forest-monitoring")
print("Все модули работают!")

Использование программы
Подготовка
Убедись, что все модули установлены.
Скачай файл forest_guard.py (или вставь код в Jupyter Notebook).
Проверь доступ к интернету (данные загружаются из GEE).
Запуск
В терминале
Перейди в папку с файлом:
bash
cd путь/к/папке
Запусти:
bash
python forest_guard.py
В Jupyter Notebook
Открой Jupyter и создай новый ноутбук.
Вставь код из forest_guard.py в ячейку.
Нажми Shift + Enter для выполнения.
Выходные данные
График: Появится окно с тремя подграфиками:
RGB-снимок Sentinel-2.
Карта классификации (зелёный — вырубка, синий — лес, красный — другое).
Прогноз времени восстановления в годах.
Файл: shebalino_clearcut_2023.tif — карта вырубки в формате GeoTIFF.
Пример вывода
Найдено снимков Sentinel-2 за 2023 с облачностью < 10%: 29
Проверка снимка: 2023-06-03, Облачность: 1.278284%
...
Снимок принят: 2023-06-13, Размер=torch.Size([4, 512, 512]), Ненулевых значений=1048576
Снимок 0: NDVI mean=0.6689, Temp=0.2928, Precip=0.1896, Soil=0.1477, Recovery=16.6211
...

Предсказанные классы: Вырубка=11751, Лес=240414, Другое=9979
Предсказанное время восстановления: 16.48 лет
Структура кода
Загрузка данных: Функции load_sentinel_data и load_environmental_data.
Генерация целей: generate_clearcut_masks и generate_recovery_targets.
Модели: ClearcutCNN (классификация) и RecoveryModel (регрессия).
Обучение: Универсальная функция train_model.
Основной цикл: Обработка, предсказание, визуализация, сохранение.
Что сделано:
Сбор данных: Использовали GEE для загрузки снимков и климатических данных за лето 2023.
Обработка: Разделили регион на субрегионы, рассчитали NDVI, нормализовали данные.
Моделирование: Обучили CNN на 300 эпохах для классификации и 50 эпохах для регрессии.
Визуализация: Построили графики и сохранили результаты в GeoTIFF.

Лицензия
Проект распространяется под лицензией MIT. Использовать свободно, но указывать авторство!
